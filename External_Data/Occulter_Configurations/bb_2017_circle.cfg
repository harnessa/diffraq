import numpy as np

## bb_2017 (broadband lab design) but with 12 petals!! ##

#Shared Details
num_pet = 12
max_apod = 0.9
is_finite = True
apod_dir = '/home/aharness/repos/diffraq/External_Data/Apodization_Profiles'

#Inner starshade
inn_starshade = {'kind':'starshade', 'is_opaque':True, 'num_petals':num_pet, \
    'edge_file':f'{apod_dir}/bb_2017__inner.txt', 'is_clocked':True, 'has_center':False}

#Outer starshade
out_starshade = {'kind':'starshade', 'is_opaque':False, 'num_petals':num_pet, \
    'edge_file':f'{apod_dir}/bb_2017__outer.txt'}

#Read max/min radii for struts and inner circle radius
with open(inn_starshade['edge_file'], 'r') as f:
    f.readline()
    strut_rmin = float(f.readline().split(',')[-1])
    circle_rad = float(f.readline().split(',')[0])

with open(out_starshade['edge_file'], 'r') as f:
    f.readline()
    strut_rmax = float(f.readline().split(',')[-1])

#Inner circle
inn_circle = {'kind':'circle', 'is_opaque':True, 'max_radius':circle_rad, \
    'theta_nodes':2/num_pet}

#Struts
struts = {'kind':'petal', 'is_opaque':True, 'num_petals':num_pet, \
    'edge_func':lambda t: 1-max_apod, 'min_radius':strut_rmin, 'max_radius':strut_rmax, \
    'has_center':False, 'is_clocked':True, 'radial_nodes':50, 'theta_nodes':50}

#Build shape list
shapes = [inn_starshade, inn_circle, out_starshade, struts]
